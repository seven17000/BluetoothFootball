<view class="container">
  <view class="card">
    <view class="card-title">数据导入</view>
    <view class="section">
      <view class="section-title">步骤1：导入基础数据</view>
      <view class="step-list">
        <text>1. 云开发 → 数据库</text>
        <text>2. 导入 database_export-players.json → players 集合</text>
        <text>3. 导入 database_export-matches.json → matches 集合</text>
        <text>4. 导入 database_export-match_records.json → match_records 集合</text>
      </view>
    </view>

    <view class="section">
      <view class="section-title">步骤2：转换数据格式</view>
      <view class="step-list">
        <text>将 playerName 转换为 playerId</text>
        <text>将 matchDate 转换为 matchId</text>
      </view>
      <button class="btn btn-primary mt-20" bindtap="transformData" loading="{{loading}}">
        开始转换
      </button>
    </view>

    <view class="section" wx:if="{{result}}">
      <view class="section-title">转换结果</view>
      <view class="result-info">
        <text>成功: {{result.successCount}} 条</text>
        <text>失败: {{result.failCount}} 条</text>
        <text wx:if="{{result.failedRecords && result.failedRecords.length > 0}}">
          失败详情:
        </text>
        <view wx:for="{{result.failedRecords}}" wx:key="index" class="fail-item">
          <text>{{item.playerName}} - {{item.reason}}</text>
        </view>
      </view>
    </view>
  </view>

  <view class="card">
    <view class="card-title">数据统计</view>
    <view class="stats-row">
      <view class="stat-item">
        <text class="value">{{stats.players}}</text>
        <text class="label">球员</text>
      </view>
      <view class="stat-item">
        <text class="value">{{stats.matches}}</text>
        <text class="label">比赛</text>
      </view>
      <view class="stat-item">
        <text class="value">{{stats.records}}</text>
        <text class="label">记录</text>
      </view>
    </view>
    <button class="btn btn-outline mt-20" bindtap="loadStats">刷新统计</button>
  </view>
</view>
