<view class="container" wx:if="{{player}}">
  <!-- 基本信息卡片 -->
  <view class="card profile-card">
    <view class="profile-header">
      <view class="avatar-wrapper">
        <image wx:if="{{player.avatar || player.photo || player.image}}" src="{{player.avatar || player.photo || player.image}}" mode="aspectFill" class="avatar-img"></image>
        <view wx:else class="avatar">{{player.number}}</view>
      </view>
      <view class="profile-info">
        <view class="name">{{player.name}}</view>
        <view class="position">
          <text wx:for="{{player.position}}" wx:key="*this">{{item}}{{index < player.position.length - 1 ? '，' : ''}}</text>
          | 球衣{{player.number}}号
        </view>
        <view class="tags" wx:if="{{player.tags && player.tags.length > 0}}">
          <text class="tag" wx:for="{{player.tags}}" wx:key="*this">{{item}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 个人信息卡片 -->
  <view class="card">
    <view class="card-title">个人信息</view>
    <view class="info-grid">
      <view class="info-item">
        <text class="info-label">性别</text>
        <text class="info-value">{{player.gender || '保密'}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">年龄</text>
        <text class="info-value">{{player.age ? player.age + '岁' : '保密'}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">身高</text>
        <text class="info-value">{{player.height ? player.height + 'cm' : '保密'}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">体重</text>
        <text class="info-value">{{player.weight ? player.weight + 'kg' : '保密'}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">联系方式</text>
        <text class="info-value">{{player.phone || '保密'}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">加入时间</text>
        <text class="info-value">{{player.joinDate || '-'}}</text>
      </view>
    </view>
  </view>

  <!-- 能力值卡片 -->
  <view class="card ability-card">
    <view class="card-title">能力值</view>
    <view class="ability-chart">
      <canvas canvas-id="abilityRadar" id="abilityRadar" class="radar-canvas"></canvas>
    </view>
    <view class="ability-list">
      <view class="ability-item" wx:for="{{allAbilityList}}" wx:key="key">
        <view class="ability-header">
          <text class="ability-icon">{{item.icon}}</text>
          <text class="ability-name">{{item.label}}</text>
          <text class="ability-value">{{player.ability[item.key] || 0}}</text>
        </view>
        <view class="ability-bar">
          <view class="ability-progress" style="width: {{(player.ability[item.key] || 0) / 100 * 100}}%;"></view>
        </view>
      </view>
    </view>
    <view class="ability-total">
      <text>综合评分：</text>
      <text class="total-value">{{abilityTotal}}</text>
    </view>
  </view>

  <!-- 近一赛季数据 -->
  <view class="card">
    <view class="card-title">近一赛季数据</view>
    <view class="match-list" wx:if="{{matchRecords.length > 0}}">
      <view class="match-record" wx:for="{{matchRecords}}" wx:key="_id" data-id="{{item.matchId}}" bindtap="goToMatch">
        <view class="record-date">{{item.matchDate}}</view>
        <view class="record-info">
          <text class="opponent">VS {{item.opponent}}</text>
          <text class="result {{item.resultClass}}">{{item.result}}</text>
        </view>
        <view class="record-stats">
          <text wx:if="{{item.goals > 0}}">{{item.goals}}球</text>
          <text wx:if="{{item.assists > 0}}">{{item.assists}}助攻</text>
        </view>
      </view>
    </view>
    <view class="empty-text" wx:elif="{{!loading && matchRecords.length === 0}}">暂无比赛记录</view>
    <!-- 加载更多按钮 -->
    <view class="loading-more" wx:if="{{loading}}">
      <text>加载中...</text>
    </view>
    <view class="loading-more" wx:elif="{{hasMore && matchRecords.length > 0}}" bindtap="loadMore">
      <text>加载更多</text>
    </view>
    <view class="loading-more" wx:elif="{{!hasMore && matchRecords.length > 0}}">
      <text>没有更多了</text>
    </view>
  </view>

  <!-- 编辑和删除按钮 -->
  <view class="action-buttons" wx:if="{{isAdmin}}">
    <view class="edit-btn" bindtap="editPlayer">编辑球员</view>
    <view class="delete-btn" bindtap="deletePlayer">删除球员</view>
  </view>
</view>

<view class="loading" wx:else>
  <text>加载中...</text>
</view>
