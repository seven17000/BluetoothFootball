<view class="container" wx:if="{{player}}">
  <!-- 基本信息卡片 -->
  <view class="card profile-card">
    <view class="profile-header">
      <view class="avatar-wrapper">
        <view class="avatar">{{player.number}}</view>
      </view>
      <view class="profile-info">
        <view class="name">{{player.name}}</view>
        <view class="position">{{player.position}} | 球衣{{player.number}}号</view>
        <view class="tags" wx:if="{{player.tags && player.tags.length > 0}}">
          <text class="tag" wx:for="{{player.tags}}" wx:key="*this">{{item}}</text>
        </view>
      </view>
      <view class="edit-btn" bindtap="editPlayer" wx:if="{{isAdmin}}">
        <text>编辑</text>
      </view>
    </view>

    <view class="profile-stats">
      <view class="stat-item">
        <text class="value">{{stats.goals}}</text>
        <text class="label">进球</text>
      </view>
      <view class="stat-item">
        <text class="value">{{stats.assists}}</text>
        <text class="label">助攻</text>
      </view>
      <view class="stat-item">
        <text class="value">{{stats.matches}}</text>
        <text class="label">出场</text>
      </view>
    </view>
  </view>

  <!-- 能力值卡片 -->
  <view class="card ability-card">
    <view class="card-title">能力值</view>
    <view class="ability-chart">
      <canvas canvas-id="abilityRadar" id="abilityRadar" class="radar-canvas"></canvas>
    </view>
    <view class="ability-list">
      <view class="ability-item" wx:for="{{allAbilityList}}" wx:key="key">
        <view class="ability-header">
          <text class="ability-icon">{{item.icon}}</text>
          <text class="ability-name">{{item.label}}</text>
          <text class="ability-value">{{player.ability[item.key] || 0}}</text>
        </view>
        <view class="ability-bar">
          <view class="ability-progress" style="width: {{(player.ability[item.key] || 0) / 100 * 100}}%;"></view>
        </view>
      </view>
    </view>
    <view class="ability-total">
      <text>综合评分：</text>
      <text class="total-value">{{abilityTotal}}</text>
    </view>
  </view>

  <!-- 比赛记录卡片 -->
  <view class="card">
    <view class="card-title">比赛记录 ({{stats.matches}}场)</view>
    <view class="match-list" wx:if="{{matchRecords.length > 0}}">
      <view class="match-record" wx:for="{{matchRecords}}" wx:key="_id">
        <view class="record-date">{{item.matchDate}}</view>
        <view class="record-info">
          <text class="opponent">VS {{item.opponent}}</text>
          <text class="result {{item.resultClass}}">{{item.result}}</text>
        </view>
        <view class="record-stats">
          <text wx:if="{{item.goals > 0}}">{{item.goals}}球</text>
          <text wx:if="{{item.assists > 0}}">{{item.assists}}助攻</text>
        </view>
      </view>
    </view>
    <view class="empty-text" wx:elif="{{!loading && matchRecords.length === 0}}">暂无比赛记录</view>
    <!-- 加载更多 -->
    <view class="loading-more" wx:if="{{loading}}">
      <text>加载中...</text>
    </view>
    <view class="loading-more" wx:elif="{{!hasMore && matchRecords.length > 0}}">
      <text>没有更多了</text>
    </view>
    <!-- 查看全部按钮 -->
    <view class="view-more" wx:if="{{stats.matches > 10}}" bindtap="viewAllMatches">
      <text>查看全部比赛记录 ({{stats.matches}}场)</text>
    </view>
  </view>

  <!-- 删除按钮 -->
  <view class="delete-btn" bindtap="deletePlayer" wx:if="{{isAdmin}}">删除球员</view>
</view>

<view class="loading" wx:else>
  <text>加载中...</text>
</view>
